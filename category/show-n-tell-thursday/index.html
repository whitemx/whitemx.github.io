<!DOCTYPE html>
<html class="no-js" lang="en-GB">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="profile" href="https://gmpg.org/xfn/11">
		
	<title>Show-n-Tell Thursday &#8211; mattwhite.me</title>
<meta name="robots" content="max-image-preview:large">
<script>document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="mattwhite.me &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="mattwhite.me &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="mattwhite.me &raquo; Show-n-Tell Thursday Category Feed" href="/category/show-n-tell-thursday/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}</style>
<link rel="stylesheet" id="blogstream-style-css" href="/wp-content/themes/blogstream/style.css?ver=6.0.1" type="text/css" media="all">
<style id="blogstream-style-inline-css" type="text/css">body { font-family: "Roboto", Arial, sans-serif; }</style>
<link rel="stylesheet" id="blogstream-responsive-css" href="/wp-content/themes/blogstream/responsive.css?ver=6.0.1" type="text/css" media="all">
<link rel="stylesheet" id="blogstream-font-awesome-css" href="/wp-content/themes/blogstream/fonts/all.min.css?ver=6.0.1" type="text/css" media="all">
<link rel="stylesheet" id="roboto-css" href="//fonts.googleapis.com/css?family=Roboto%3A400%2C300italic%2C300%2C400italic%2C700&#038;subset=latin%2Clatin-ext&#038;ver=6.0.1" type="text/css" media="all">
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.6.0" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<script type="text/javascript" src="/wp-content/themes/blogstream/js/slick.min.js?ver=6.0.1" id="blogstream-slick-js"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/categories/154">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 6.0.1">
<style id="kirki-inline-styles"></style>
</head>

<body class="archive category category-show-n-tell-thursday category-154 col-2cl full-width logged-out">

<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0.49803921568627"></fefuncr><fefuncg type="table" tablevalues="0 0.49803921568627"></fefuncg><fefuncb type="table" tablevalues="0 0.49803921568627"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 0.27843137254902"></fefuncg><fefuncb type="table" tablevalues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0"></fefuncr><fefuncg type="table" tablevalues="0 0.64705882352941"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.78039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.94901960784314"></fefuncg><fefuncb type="table" tablevalues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.098039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.66274509803922"></fefuncg><fefuncb type="table" tablevalues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg>
<a class="skip-link screen-reader-text" href="#page">Skip to content</a>

<div id="wrapper">

	<div id="header-sticky">
		<header id="header" class="hide-on-scroll-down nav-menu-dropdown-left">

			<div class="pad group">

				<p class="site-title"><a href="/" rel="home">mattwhite.me</a></p>
									<p class="site-description"></p>
								
																	
			</div>
			
		</header><!--/#header-->
	</div>
<!--/#header-sticky-->

	<div id="header-bottom" class="group">
	
				
				
					<div class="search-trap-focus">
				<button class="toggle-search" data-target=".search-trap-focus">
					<svg class="svg-icon" id="svg-search" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewbox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)"></path></svg>
					<svg class="svg-icon" id="svg-close" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewbox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102"></polygon></svg>
				</button>
				<div class="search-expand">
					<div class="search-expand-inner">
						<form method="get" class="searchform themeform" action="/">
	<div>
		<input type="text" class="search" name="s" onblur="if(this.value=='')this.value='To search type and hit enter';" onfocus="if(this.value=='To search type and hit enter')this.value='';" value="To search type and hit enter">
	</div>
</form>					</div>
				</div>
			</div>
				
	</div>
<!--/#header-bottom-->

	<div id="wrapper-inner">

				
		<div class="container" id="page">
			<div class="container-inner">			
				<div class="main">
					<div class="main-inner group">

<div class="content">
		
	<div class="page-title group">
	<div class="page-title-inner group">
	
					<h1>
<i class="far fa-folder"></i>Show-n-Tell Thursday</h1>

		
								
	</div>
<!--/.page-title-inner-->
</div>
<!--/.page-title-->	
			
		<div class="entry-wrap">		
							
<article id="post-1333" class="wrap-entry-line post-1333 post type-post status-publish format-standard hentry category-show-n-tell-thursday tag-excel tag-http tag-ssjs tag-xpages">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2010-7-14-forcing-a-file-name-when-downloading-a-dynamically-generated-html/" rel="bookmark">Forcing a file name when downloading a dynamically generated csv file</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>Over the last couple of weeks I&#8217;ve been working on a customisation project using IQJam as a starting point and then making it better fit a particular customer&#8217;s requirements. It&#8217;s worth mentioning as I finally had the justification to spend a little time investigating a problem which has been bugging me.</p>
<p>One of the features I added to IQJam was the ability to export data to Excel, a common enough feature that you&#8217;ve been able to do in Domino for ever. Simply print data out to the browser in simple HTML format and change the content-type of the page to &#8220;application/vnd.ms-excel&#8221;. That&#8217;s not the point of this posting really.</p>
<p>The problem I&#8217;ve been trying to work around is that if your user is using Excel 2007 or later (I&#8217;m only on the beta of Office 2010 but it still seems to be a problem for me anyway) and you use the printing HTML technique, Excel raises an error for the user when they load the page, something like:</p>
<blockquote><p>The file you are trying to open, &#8216;name.ext&#8217;, is in a different format than specified by the file extension. Verify that the file is not corrupted and is from a trusted source before opening the file. Do you want to open the file now?</p></blockquote>
<p>According to various <a href="http://support.microsoft.com/kb/948615">technotes</a> and <a href="http://blogs.msdn.com/b/vsofficedeveloper/archive/2008/03/11/excel-2007-extension-warning.aspx">blog posts</a> there is no work around for this, it is a deliberate security feature of Excel. Fair enough I can live with this, though it&#8217;s not acceptable to the end user, so instead of generating an Excel file I reverted to generated CSV formatted data.</p>
<p>The thing I learned from my investigations into the Excel problem was that there is this header which you can add to the data being generated which tells the browser that the page being opened is actually a file attachment and what the name of the file you want to download should be. So in my example, I&#8217;m able to create a unique file name every time the page is generated and also specify that it should be saved as a CSV file, not .XSP which is what it would be thanks to the page being loaded being an XPage. See this example:</p>
<blockquote><p>try{<br> &nbsp;&nbsp;&nbsp;&nbsp;var exCon = facesContext.getExternalContext(); <br> &nbsp;&nbsp;&nbsp;&nbsp;var writer = facesContext.getResponseWriter();<br> &nbsp;&nbsp;&nbsp;&nbsp;var response = exCon.getResponse();<br> &nbsp;&nbsp;&nbsp;&nbsp;response.setContentType(&#8220;text/csv&#8221;);<br> &nbsp;&nbsp;&nbsp;&nbsp;response.setHeader(&#8220;Content-disposition&#8221;, &#8220;attachment; filename=export_&#8221; + DateConverter.dateToString(@Now(), &#8220;yyyyMMddhhmm&#8221;) + &#8220;.csv&#8221;);<br> &nbsp;&nbsp;&nbsp;&nbsp;response.setHeader(&#8220;Cache-Control&#8221;, &#8220;no-cache&#8221;);<br> &nbsp;&nbsp;&nbsp;&nbsp;writer.write(getCSVBody());<br> &nbsp;&nbsp;&nbsp;&nbsp;writer.endDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;facesContext.responseComplete();<br> &nbsp;&nbsp;&nbsp;&nbsp;writer.close();<br> }catch(e){<br> &nbsp;&nbsp;&nbsp;&nbsp;_dump(e);<br> }</p></blockquote>
<p>So this server side javascript sits in the afterRenderResponse of my XPage and is using the &#8220;<a href="http://www.wissel.net/blog/d6plinks/SHWL-7MGFBN">web agents XPages style</a>&#8221; technique which Stephan first documented to generate non HTML content from an XPage. The key line for this blog post is where the &#8220;Content-disposition&#8221; header is set, hopefully you can see where the filename is being created (I&#8217;m also using <a href="http://dontpanic82.blogspot.com/2010/04/xpages-code-snippet-for-datestring.html">Tommy Valand&#8217;s DateConverter SSJS code</a> to get the current date / time formatted into a nice string).</p>
<p>Anyway, not a new technique looking at the dates on some of the internet postings out there, but a new one on me and worth passing on I thought.</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">July 14, 2010</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2010-7-14-forcing-a-file-name-when-downloading-a-dynamically-generated-html/#comments"><i class="fas fa-comment"></i><span>3</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1334" class="wrap-entry-line post-1334 post type-post status-publish format-standard hentry category-show-n-tell-thursday tag-ajax tag-chrome tag-ideajam">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2010-2-25-be-very-careful-with-your-content-type-for-chrome-ajax-reque-html/" rel="bookmark">Be very careful with your content type for Chrome Ajax requests</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>We released the first beta for <a href="http://ideajam.net/">IdeaJam 1.7</a> today. There are *tons* of changes under the covers including the new MooTools 1.2 framework, on which you can expect more later this week.</p>
<p>But for the moment, I thought I&#8217;d pass along one little tip which we ran into. Inevitably during our own testing we had missed this bug. When you&#8217;re in an idea you can &#8220;Click to show votes&#8221; and what happens behind the scenes is that an Ajax request is fired off to our votes database, an agent runs and send back a list of the votes related to that idea, when they were cast, who by and so on. That agent had been set up with the following code at the start:</p>
<blockquote>
<div id="_mcePaste">Print |Content-Type:text/javascript; charset=utf-8|</div>
<div id="_mcePaste">
<span> </span>Print |Cache-Control: no-cache|</div>
</blockquote>
<div>But what we are actually doing is pre-building some HTML and then just inserting it into a div, it saves a little bit of browser processing time this way. But in Chrome we were getting an error:</div>
<blockquote>
<div>Uncaught SyntaxError: Unexpected token &lt;</div>
</blockquote>
<div>It took a while to track down the problem, but now I found it, it&#8217;s obvious. The content-type of the agent needs to actually be set to text/html, not text/javascript. All of the other browsers worked fine with this oversight, even Safari which is a fellow Webkit browser, but Chrome seems to be a lot more picky. So this is just a reminder to make sure you&#8217;re very precise with what is being sent to Chrome from your server.</div>
<p>&nbsp;</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">February 25, 2010</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2010-2-25-be-very-careful-with-your-content-type-for-chrome-ajax-reque-html/#comments"><i class="fas fa-comment"></i><span>2</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1335" class="wrap-entry-line post-1335 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2009-4-23-xpages-displaying-a-view-inside-a-dojo-dialog-html/" rel="bookmark">XPages: Displaying a view inside a Dojo Dialog</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>This is my first SnTT post for absolutely ages, but, hopefully I&#8217;ll be able to do quite a few more over the next few months as I am just starting a brand new XPages project for a customer that runs through until August.</p>
<p>One of the first things I have been bashing my head against the development wall over is how to get a view to act as a picklist in a dialog. In theory, it should be pretty easy, you just add the &#8220;dijit.Dialog&#8221; to your XPage resources like so:</p>
<p><img src="http://img.skitch.com/20090423-xi5n4anc62asnfwjman884u9x3.jpg"></p>
<p>Don&#8217;t forget to also enable the dojoParseOnLoad and dojoTheme properties at the same time.Then inside your XPage you&#8217;ll want to actually create the dialog HTML:</p>
<p><img src="http://img.skitch.com/20090423-emw7i49srkaercfk1jbrdstk3.jpg"></p>
<p>At this point I had assumed that I could just add my view control inside the div and Bob, as they say, would be my mother&#8217;s brother. But I hadn&#8217;t catered for Dojo taking control of the HTML in the XPage once it was rendered. Basically what happens is that after the page loads, Dojo moves the div I created out of the Domino generated form and makes it a child of the body element. This displays fine, until you try and navigate through the view using the pager control, which no longer works as the javascipt requires the HTML to beinside the Domino form. So as far I can tell you have a couple of options, either move the div back inside the form, but I&#8217;m assuming that Dojo moved it out for a reason so I wanted to avoid that.</p>
<p>In the end I moved the view control itself to be in a standalone XPage and then opened that via an iFrame that is embedded inside the dialog div. It&#8217;s just a matter then of changing my javascript to refer to window.parent when I want to send values back from the dialog to the main XPage.</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">April 23, 2009</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2009-4-23-xpages-displaying-a-view-inside-a-dojo-dialog-html/#comments"><i class="fas fa-comment"></i><span>1</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1336" class="wrap-entry-line post-1336 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2008-10-9-tips-for-referencing-elements-in-xpages-javascript-html/" rel="bookmark">Tips for referencing elements in XPages JavaScript</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>I managed to hit a bit of a wall with my IdeaJam on XPages development this week. Up until now I haven&#8217;t really needed to write any client side JavaScript which is impressive in itself compared to how much client side scripts we have in IdeaJam classic. But I have reached that point where I want to add some interactivity without round-tripping to the server.</p>
<p>In classic Domino it&#8217;s very easy to write script that refers to specific elements of the HTML because you get to control the IDs of those elements. But with XPages it is not possible to predict what the name of an element will be when it reaches the browser. So you are provided with a couple of functions to help you out. When you&#8217;re writing client side Javascript in an XPage client side event (like clicking a button) it&#8217;s very easy, the syntax you use to reference an element is &#8220;#{id:myElement}&#8221; in place of the id. So for example you could use:</p>
<p>dojo.byId(&#8220;#{id:myDiv}&#8221;).style.display = &#8220;none&#8221;;</p>
<p>But the thing that I didn&#8217;t know about until <a href="http://www.jmackey.net/">John Mackey</a> gave me some help was that there is a second way of getting the ID of an element. My specific problem was that I wanted to have a script run when the page finishes loading and that script needed to go and work on several different elements. It&#8217;s easy enough to make a script run &#8220;onload&#8221;. You can actually write JavaScript directly into the source XML of the XPage, so I have added, at the top of my XPage something like this:</p>
<p>&lt;script language=&#8221;Javascript&#8221;&gt;<br>
XSP.addOnLoad(function () {<br>
initLocal();<br>
}<br>
);<br>
&lt;/script&gt;</p>
<p>This will tell Dojo to call the function &#8220;initLocal()&#8221; when the page has finished loading, no problem there. But my initLocal function needs to reference an element on the page and I can&#8217;t use the &#8220;#{id:myElement}&#8221; format as that only gets evaluated in events that are provided for you by the XPage, enter the &#8220;getClientId()&#8221; function. You can add a computed field to the XPage that has JavaScript embedded within it in the following format:</p>
<p>var out=&#8221;&lt;script language=\&#8221;Javascript\&#8221;&gt;\n&#8221;;<br>
out += &#8220;var myElementId = \&#8221;&#8221; + getClientId(&#8220;myElement&#8221;) + &#8220;\&#8221;;\n&#8221;;<br>
out += &#8220;function initLocal(){\n&#8221;;<br>
out += &#8220;myFunction(myElementId);\n&#8221;;<br>
out += &#8220;}\n&#8221;;<br>
out += &#8220;&lt;/script&gt;&#8221;;<br>
out</p>
<p>And by the time it makes it out the the browser it has been translated into:</p>
<p>&lt;script language=&#8221;Javascript&#8221;&gt;<br>
var myElementId = &#8220;view:_id1:_id2:content:_id4:myElement&#8221;;<br>
function initLocal(){<br>
myFunction(myElementId);<br>
}<br>
&lt;/script&gt;</p>
<p>So in the initLocal function I call another function which is held in a Client Side JavaScript library and I pass in the element ID so that the function can reference the element on the page with proper separation between UI and business logic. So it&#8217;s all a bit round the houses but this way of doing things does work well and hopefully you won&#8217;t need to go through the pain that I have in working this stuff out.</p>
<p>Finally a big thanks to <a href="http://www.jmackey.net/">John Mackey</a> for his help, this is when the Lotus community really proves it&#8217;s worth</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">October 9, 2008</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2008-10-9-tips-for-referencing-elements-in-xpages-javascript-html/#comments"><i class="fas fa-comment"></i><span>11</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1337" class="wrap-entry-line post-1337 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2008-10-6-character-encoding-in-an-ajax-lotusscript-agent-html/" rel="bookmark">Character encoding in an Ajax LotusScript agent</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>I know it&#8217;s Monday, but I thought I&#8217;d share this with you anyway.</p>
<p>So, most people know that you can control the <a href="http://en.wikipedia.org/wiki/MIME#Content-Type">content-type</a> in an agent called by an Ajax request (or any type of agent for that matter) by using this line:</p>
<p>print |content-type: text/plain|</p>
<p>which will result in plain text being sento to the browser, of course you can also send HTML, XML, JSON or any other content type that you so choose.</p>
<p>What you may not have known is that you can also control the charset property of the response. Why would you want to do this? Well if you have an agent that returns high number Ascii characters such as &eacute; or &ouml; then by default they will be returned to the Ajax request as non-printing characters. But if you use this line in your agent then they will be transferred to your browser correctly:</p>
<p>print |content-type: text/plain; charset=utf-8|</p>
<p>So my recommendation is that for every agent that you write where you would have just set the content-type, just take that extra few seconds to define the character set as well to save yourself trouble down the line.</p>
<p>You may well take from this, that I have just been burned by this very issue, and you may well be correct. Did I mention that version 1.3 of IdeaJam will be released very shortly 😉</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">October 6, 2008</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2008-10-6-character-encoding-in-an-ajax-lotusscript-agent-html/#comments"><i class="fas fa-comment"></i><span>3</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1338" class="wrap-entry-line post-1338 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2008-2-6-using-easymock-for-disconnected-domino-java-testing-html/" rel="bookmark">Using easymock for disconnected Domino Java testing</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>One of the projects I&#8217;m working on at the moment has a *lot* of code written in a J2EE application which talks to Oracle using JDBC and Domino over CORBA. It actually all works really well but the approach of one of our non-Domino developers was really interesting to me, so I asked if I could write about it up here.</p>
<p>So the approach that Greg takes is <a href="http://en.wikipedia.org/wiki/Test-driven_development">test driven development</a>, that is he writes his tests before writing the code. For his testing he would rather not connect to the Domino server all the time, but instead mock up objects to make sure that his other code works correctly. Enter <a href="http://www.easymock.org/">EasyMock</a>, which is a JAR file which you can include in any project that basically pretends to be whatever object you want it to be.</p>
<style type="text/css"><!--code { font-family: Courier New, Courier; font-size: 10pt; margin: 0px; }--></style>
<p><!-- ======================================================== --><br>
<!-- = Java Sourcecode to HTML automatically converted code = --><br>
<!-- =   Java2Html Converter 5.0 [2006-02-26] by Markus Gebhard  markus@jave.de   = --><br>
<!-- =     Further information: http://www.java2html.de     = --></p>
<div align="left" class="java">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
<tr>
  <!-- start source code -->
<td nowrap valign="top" align="left">
    <code><br>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">test;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">junit.framework.*;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.Vector;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.easymock.EasyMock;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.easymock.*;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;static&nbsp;</b></font><font color="#000000">org.easymock.EasyMock.*;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">lotus.domino.*;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">com.agcs.cores.utilities.*;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">testDominoFieldProcessing&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">TestCase&nbsp;</font><font color="#000000">{</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">Document&nbsp;mock&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">DateTime&nbsp;datemock&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">DominoFieldProcessing&nbsp;dfield&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">{</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mock&nbsp;=&nbsp;createMock</font><font color="#000000">(</font><font color="#000000">Document.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Vector&lt;DateTime&gt;&nbsp;v&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Vector&lt;DateTime&gt;</font><font color="#000000">()</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>for&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">i&nbsp;=&nbsp;</font><font color="#990000">0</font><font color="#000000">;&nbsp;i&lt;&nbsp;</font><font color="#990000">3</font><font color="#000000">;i++</font><font color="#000000">)</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">{</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">datemock&nbsp;=&nbsp;createMock</font><font color="#000000">(</font><font color="#000000">DateTime.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">expect</font><font color="#000000">(</font><font color="#000000">datemock.getLocalTime</font><font color="#000000">())</font><font color="#000000">.andReturn</font><font color="#000000">(</font><font color="#2a00ff">&#34;01:02:03&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">expect</font><font color="#000000">(</font><font color="#000000">datemock.toJavaDate</font><font color="#000000">())</font><font color="#000000">.andReturn</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">java.util.Date</font><font color="#000000">(</font><font color="#000000">System.currentTimeMillis</font><font color="#000000">()&nbsp;&nbsp;&nbsp;))</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">v.add</font><font color="#000000">(</font><font color="#000000">datemock</font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">replay</font><font color="#000000">(</font><font color="#000000">datemock</font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">expect</font><font color="#000000">(</font><font color="#000000">mock.getItemValue</font><font color="#000000">(</font><font color="#2a00ff">&#34;time&#34;</font><font color="#000000">))</font><font color="#000000">.andReturn</font><font color="#000000">(</font><font color="#000000">v</font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">expect</font><font color="#000000">(</font><font color="#000000">mock.hasItem</font><font color="#000000">(</font><font color="#2a00ff">&#34;time&#34;</font><font color="#000000">))</font><font color="#000000">.andReturn</font><font color="#000000">(</font><font color="#7f0055"><b>true</b></font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">replay</font><font color="#000000">(</font><font color="#000000">mock</font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">}</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testNotesDateToJavaDate</font><font color="#000000">()&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">{</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>for&nbsp;</b></font><font color="#000000">(</font><font color="#000000">java.util.Date&nbsp;d:&nbsp;&nbsp;DominoFieldProcessing.getFieldValueAsListDate</font><font color="#000000">(</font><font color="#000000">mock,</font><font color="#2a00ff">&#34;time&#34;</font><font color="#000000">))</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#000000">d</font><font color="#000000">)</font><font color="#000000">;</font><br>
<font color="#ffffff"></font><br>
<font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">}</font><br>
<font color="#ffffff"></font><br>
<font color="#000000">}</font><br>
<font color="#ffffff"></font><font color="#ffffff"><br>
</font></code>
</td>
<p>  <!-- end source code --><br>
   </p>
</tr>
<p>  <!-- start Java2Html link --></p>
<tr>
<td align="right">
<small><br>
<a href="http://www.java2html.de/" target="_blank" rel="noopener">Java2html</a><br>
</small>
    </td>
</tr>
<p>  <!-- end Java2Html link --><br>
</p>
</table>
</div>
<p><!-- =       END of automatically generated HTML code       = --><br>
<!-- ======================================================== --></p>
<p>What this code shows is the use of EasyMock to be a Notes Document and a DateTime Object. You tell it what the methods that you want to call should return, and then, for all intents and purposes, the object is a Domino object but without having to go through the hassle of deploying your code to a server which has the rights to connect to a proper Domino server. Now of course this should only be used early on in the development lifecycle, but for environments where connecting to Domino can be difficult this is a real time saver.</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">February 6, 2008</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2008-2-6-using-easymock-for-disconnected-domino-java-testing-html/#comments"><i class="fas fa-comment"></i><span>1</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1339" class="wrap-entry-line post-1339 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2007-3-8-webdav-tip-html/" rel="bookmark">WebDAV tip</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>I spent a little time last night getting <a href="http://www.webdav.org/">WebDAV</a> enabled on a database and server so that I could upload the latest version of Dojo as file resource design elements. Unfortunately it took a little more time than expected. Of course <a href="http://codestore.net/">Jake</a> has an <a href="http://www.codestore.net/store.nsf/unid/FISR-6U8SN7?OpenDocument">article</a> on how to set it up but the one thing which I missed for about half an hour of swearing was that you <u>must</u> check the design locking box in the database properties as well as everything else. The Administration documentation is ambiguous on this point from my view.</p>
<p>So hopefully if people are seeing the message &#8220;The HTTP method is not allowed for the specified URL&#8221; when trying to copy a file into the Domino database using Windows Explorer (or indeed the OS X Finder although the error message is somewhat less helpful there!) then a quick Google should find this page.</p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">March 8, 2007</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2007-3-8-webdav-tip-html/#comments"><i class="fas fa-comment"></i><span>1</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1340" class="wrap-entry-line post-1340 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2007-1-1-lotusscript-to-make-a-new-web-user-able-to-log-in-immediatel-html/" rel="bookmark">LotusScript to Make a new web user able to log in immediately</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p><a href="http://www.billbuchan.com/">Bill</a> offered some advice <a href="http://www.11tmr.com/11tmr.nsf/d6plinks/MWHE-6WZE7J#comments">yesterday</a> about a problem I&#8217;ve been having with new user registrations for <a href="http://www.defectr.com/">Defectr</a>.</p>
<p>What was happening was that a new user would register, everything would work fine but it took up to 15 minutes for the new account to work. I thought I had tried all combinations of solution but am also running the Defectr registrations in a Directory Assistance NAB (ie not the primary NAB on the server) so assumed that that was the source of the problem. But Bill&#8217;s posting spurred me to have another quick look and it seems like I&#8217;ve got it fixed now.</p>
<p>All of the work I had been doing was around refreshing views in the NAB in which the users were being created, it never occurred to me to refresh the same views in the main NAB but when I did the new account worked straight away. I have no idea why this would be the case, any idea you admin types?</p>
<p>Anyway, this is the code I now run when a new user registers:</p>
<blockquote>
<style>.lotusscript { font-family: sans-serif; font-size: 9pt; color: black; }
.ls-comment { color: green; }
.ls-quote { color: black; }
.ls-datatype { color: black; }
.ls-operator { color: blue; }
.ls-keyword { color: blue; }
.ls-statement { color: blue; }
.ls-function { color: blue; }
.ls-class { color: black; }
.ls-constant { color: purple; }</style>
<pre><div class="lotusscript">
<font class="ls-keyword">Option</font> <font class="ls-keyword">Public</font>
<font class="ls-keyword">Option</font> <font class="ls-keyword">Declare</font>
<font class="ls-statement">Use</font> <font class="ls-quote">"OpenLogFunctions"</font>
<font class="ls-statement">Use</font> <font class="ls-quote">"slnnotesdll"</font>

<font class="ls-statement">Sub</font> UpdateNAB
	<font class="ls-statement">On</font> <font class="ls-function">Error</font> <font class="ls-keyword">Goto</font> Whoops
	
	<font class="ls-statement">Dim</font> commander <font class="ls-keyword">As</font> <font class="ls-keyword">New</font> nnotesdll
	<font class="ls-statement">Dim</font> sess <font class="ls-keyword">As</font> <font class="ls-keyword">New</font> <font class="ls-class">NotesSession</font>
	<font class="ls-statement">Dim</font> strError <font class="ls-keyword">As</font> <font class="ls-keyword">String</font>
	<font class="ls-statement">Dim</font> server <font class="ls-keyword">As</font> <font class="ls-keyword">String</font>
	<font class="ls-statement">Dim</font> scommand <font class="ls-keyword">As</font> <font class="ls-keyword">String</font>
	<font class="ls-statement">Dim</font> strResponse <font class="ls-keyword">As</font> <font class="ls-keyword">String</font>
	
	Server <font class="ls-operator">=</font> sess<font class="ls-operator">.</font>CurrentDatabase<font class="ls-operator">.</font>Server
	
	sCommand <font class="ls-operator">=</font> <font class="ls-quote">|load updall names.nsf -t "($ServerAccess)" -r|</font>
	strResponse<font class="ls-operator">=</font><font class="ls-quote">""</font>
	strError<font class="ls-operator">=</font>commander<font class="ls-operator">.</font>rConsole<font class="ls-operator">(</font>Server<font class="ls-operator">,</font>sCommand<font class="ls-operator">,</font>strResponse<font class="ls-operator">)</font>
	<font class="ls-function">Sleep</font> 1
	
	sCommand <font class="ls-operator">=</font> <font class="ls-quote">|load updall names.nsf -t "($Users)" -r|</font>
	strResponse<font class="ls-operator">=</font><font class="ls-quote">""</font>
	strError<font class="ls-operator">=</font>commander<font class="ls-operator">.</font>rConsole<font class="ls-operator">(</font>Server<font class="ls-operator">,</font>sCommand<font class="ls-operator">,</font>strResponse<font class="ls-operator">)</font>
	<font class="ls-function">Sleep</font> 1
	
	sCommand <font class="ls-operator">=</font> <font class="ls-quote">|dbcache flush|</font>
	strResponse<font class="ls-operator">=</font><font class="ls-quote">""</font>
	strError<font class="ls-operator">=</font>commander<font class="ls-operator">.</font>rConsole<font class="ls-operator">(</font>Server<font class="ls-operator">,</font>sCommand<font class="ls-operator">,</font>strResponse<font class="ls-operator">)</font>	
	<font class="ls-function">Sleep</font> 1
	
	sCommand <font class="ls-operator">=</font> <font class="ls-quote">"Tell Adminp Process People"</font>
	strResponse<font class="ls-operator">=</font><font class="ls-quote">""</font>
	strError<font class="ls-operator">=</font>commander<font class="ls-operator">.</font>rConsole<font class="ls-operator">(</font>Server<font class="ls-operator">,</font>sCommand<font class="ls-operator">,</font>strResponse<font class="ls-operator">)</font>
	
	<font class="ls-function">Sleep</font> 1
	
	sCommand <font class="ls-operator">=</font> <font class="ls-quote">"Show nlcache reset"</font>
	strResponse<font class="ls-operator">=</font><font class="ls-quote">""</font>
	strError<font class="ls-operator">=</font>commander<font class="ls-operator">.</font>rConsole<font class="ls-operator">(</font>Server<font class="ls-operator">,</font>sCommand<font class="ls-operator">,</font>strResponse<font class="ls-operator">)</font>
	
	<font class="ls-statement">Exit</font> <font class="ls-statement">Sub</font>	
Whoops<font class="ls-operator">:</font>
	<font class="ls-function">Call</font> LogError<font class="ls-operator">(</font><font class="ls-operator">)</font>
	gResponse <font class="ls-operator">=</font> <font class="ls-quote">"ERROR: "</font> <font class="ls-operator">+</font> <font class="ls-function">Error</font>
	<font class="ls-statement">Exit</font> <font class="ls-statement">Sub</font>
<font class="ls-statement">End</font> <font class="ls-statement">Sub</font>
</div></pre>
<div style="FONT-SIZE: 8pt; COLOR: gray; FONT-FAMILY: sans-serif; BORDER: 1 solid Grey; margin : 5px 50px 5px 50px;"><center>This LotusScript was converted to HTML using the <b><i>ls2html</i></b> routine,<br>provided by Julian Robichaux at <a href="http://www.nsftools.com/" target="_blank" rel="noopener">nsftools.com</a>.</center></div>
</blockquote>
<p>
Tags: <a href="http://technorati.com/tag/Show-N-Tell+Thursday">Show-N-Tell Thursday</a></p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">January 1, 2007</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2007-1-1-lotusscript-to-make-a-new-web-user-able-to-log-in-immediatel-html/#comments"><i class="fas fa-comment"></i><span>6</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1341" class="wrap-entry-line post-1341 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2006-10-29-lotusscript-class-to-convert-numbers-to-words-in-french-html/" rel="bookmark">LotusScript Class to Convert Numbers to Words in French</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>A bit of an obscure one this, but we are making an English application multi lingual. One function converts numbers to words, and having tried to use the same logic for the French translations it just doesn&#8217;t work so I spent a couple of hours this morning porting a <a href="http://www.rgagnon.com/javadetails/java-0426.html">Java class</a> to work in LotusScript to perform the function:</p>
<pre style="BORDER-RIGHT: #999999 1px dashed; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px dashed; PADDING-LEFT: 5px; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; OVERFLOW: auto; BORDER-LEFT: #999999 1px dashed; WIDTH: 100%; COLOR: #000000; LINE-HEIGHT: 14px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px dashed; FONT-FAMILY: Andale Mono, Lucida Console, Monaco, fixed, monospace; BACKGROUND-COLOR: #eee"><code>'**********************************************************
'*Ported from Java Class found at:
'*http://www.rgagnon.com/javadetails/java-0426.html
'**********************************************************
Class FrenchDecimalFormat
&nbsp;&nbsp;tenNames() As String
&nbsp;&nbsp;uniteNames1() As String
&nbsp;&nbsp;uniteNames2() As String
&nbsp;&nbsp;
&nbsp;&nbsp;Sub new()
&nbsp;&nbsp;&nbsp;&nbsp;Redim tenNames(9)
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(0) = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(1) = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(2) = &quot;vingt&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(3) = &quot;trente&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(4) = &quot;quarante&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(5) = &quot;cinquante&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(6) = &quot;soixante&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(7) = &quot;soixante&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(8) = &quot;quatre-vingt&quot;
&nbsp;&nbsp;&nbsp;&nbsp;tenNames(9) = &quot;quatre-vingt&quot;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Redim uniteNames1(19)
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(0) = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(1) = &quot;un&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(2) = &quot;deux&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(3) = &quot;trois&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(4) = &quot;quatre&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(5) = &quot;cinq&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(6) = &quot;six&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(7) = &quot;sept&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(8) = &quot;huit&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(9) = &quot;neuf&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(10) = &quot;dix&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(11) = &quot;onze&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(12) = &quot;douze&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(13) = &quot;treize&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(14) = &quot;quatorze&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(15) = &quot;quinze&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(16) = &quot;seize&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(17) = &quot;dix-sept&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(18) = &quot;dix-huit&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames1(19) = &quot;dix-neuf&quot;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Redim uniteNames2(10)
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(0) = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(1) = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(2) = &quot;deux&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(3) = &quot;trois&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(4) = &quot;quatre&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(5) = &quot;cinq&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(6) = &quot;six&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(7) = &quot;sept&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(8) = &quot;huit&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(9) = &quot;neuf&quot;
&nbsp;&nbsp;&nbsp;&nbsp;uniteNames2(10) = &quot;dix&quot;
&nbsp;&nbsp;End Sub
&nbsp;&nbsp;
&nbsp;&nbsp;Function convertZeroToHundred(number As Integer) As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim laten As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim lUnite As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim result As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim joiner As String
&nbsp;&nbsp;&nbsp;&nbsp;laten = Fix(number / 10)
&nbsp;&nbsp;&nbsp;&nbsp;lUnite = number Mod 10
&nbsp;&nbsp;&nbsp;&nbsp;result = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;If laten = 1 Or laten = 7 Or laten = 9 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lUnite = lUnite + 10
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;joiner = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;If laten &gt; 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joiner = &quot;-&quot;
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;If lUnite = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joiner = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Elseif lUnite = 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If laten = 8 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joiner = &quot;-&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joiner = &quot; et &quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;Elseif lUnite = 11 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If laten = 7 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joiner = &quot; et &quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;If laten = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = uniteNames1(lUnite)
&nbsp;&nbsp;&nbsp;&nbsp;Elseif laten = 8 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If lUnite = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = tenNames(laten)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = tenNames(laten) + joiner + uniteNames1(lUnite)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = tenNames(laten) + joiner + uniteNames1(lUnite)
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;convertZeroToHundred = result
&nbsp;&nbsp;End Function
&nbsp;&nbsp;
&nbsp;&nbsp;Function convertLessThanOneThousand(number As Integer)
&nbsp;&nbsp;&nbsp;&nbsp;Dim hundreds As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim remainder As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim strRemainder As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim result As String
&nbsp;&nbsp;&nbsp;&nbsp;hundreds = Fix(number / 100)
&nbsp;&nbsp;&nbsp;&nbsp;remainder = number Mod 100
&nbsp;&nbsp;&nbsp;&nbsp;strRemainder = convertZeroToHundred(remainder)
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;If hundreds = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = strRemainder
&nbsp;&nbsp;&nbsp;&nbsp;Elseif hundreds = 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If remainder &gt; 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = &quot;cent &quot; + strRemainder
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = &quot;cent&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If remainder &gt; 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = uniteNames2(hundreds) + &quot; cent &quot; + strRemainder
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = uniteNames2(hundreds) + &quot; cents&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;convertLessThanOneThousand = result
&nbsp;&nbsp;End Function
&nbsp;&nbsp;
&nbsp;&nbsp;Function convert(number As Double)
&nbsp;&nbsp;&nbsp;&nbsp;Dim snumber As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim billions As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim millions As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim hundredthousands As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim thousands As Integer
&nbsp;&nbsp;&nbsp;&nbsp;Dim strBillions As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim strMillions As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim strHundredThousands As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim strThousands As String
&nbsp;&nbsp;&nbsp;&nbsp;Dim result As String
&nbsp;&nbsp;&nbsp;&nbsp;If number = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert = &quot;z&eacute;ro&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit Function
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;snumber = Cstr(number)
&nbsp;&nbsp;&nbsp;&nbsp;snumber = Format$(number, &quot;000000000000&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;billions = Cint(Left$(snumber, 3)) ' XXXnnnnnnnnn
&nbsp;&nbsp;&nbsp;&nbsp;millions&nbsp;&nbsp;= Cint(Mid$(snumber, 4,3)) ' nnnXXXnnnnnn
&nbsp;&nbsp;&nbsp;&nbsp;hundredthousands = Cint(Mid$(snumber, 7, 3))&nbsp;&nbsp;' nnnnnnXXXnnn
&nbsp;&nbsp;&nbsp;&nbsp;thousands = Cint(Mid$(snumber, 10, 3))&nbsp;&nbsp;' nnnnnnnnnXXX
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;If billions = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strBillions = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Elseif billions = 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strBillions = convertLessThanOneThousand(billions) + &quot; milliard &quot;
&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strBillions = convertLessThanOneThousand(billions) + &quot; milliards &quot;
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;result =&nbsp;&nbsp;strBillions
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;If millions = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMillions = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Elseif millions = 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMillions = convertLessThanOneThousand(millions) + &quot; million &quot;
&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMillions = convertLessThanOneThousand(millions) + &quot; millions &quot;
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;result = result + strMillions
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;If hundredthousands = 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strHundredThousands = &quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Elseif hundredthousands = 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strHundredThousands = &quot;mille &quot;
&nbsp;&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strHundredThousands = convertLessThanOneThousand(hundredthousands) + &quot; mille &quot;
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;result = result + strHundredThousands
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;strThousands = convertLessThanOneThousand(thousands)
&nbsp;&nbsp;&nbsp;&nbsp;result =&nbsp;&nbsp;result + strThousands
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;convert = result
&nbsp;&nbsp;End Function
End Class&amp;#0;&amp;#0;&amp;#0;
</code></pre>
<p>
Tags: <a href="http://technorati.com/tag/Show-N-Tell+Thursday">Show-N-Tell Thursday</a></p>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">October 29, 2006</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2006-10-29-lotusscript-class-to-convert-numbers-to-words-in-french-html/#respond"><i class="fas fa-comment"></i><span>0</span></a>
					</div>
	</div>

</article><!--/.post-->								
<article id="post-1342" class="wrap-entry-line post-1342 post type-post status-publish format-standard hentry category-show-n-tell-thursday">	
	
	<div class="entry-line">
		<div class="entry-line-inner">
			<div class="entry-line-bullet">
				<div class="entry-line-bullet-inner"></div>
			</div>
		</div>
	</div>
	
	<div class="post-wrapper entry-line-entry group">
		<header class="entry-header group">
			<h2 class="entry-title"><a href="/2006-9-27-posting-to-a-form-for-ajax-validation-html/" rel="bookmark">Posting to a Form for AJAX validation</a></h2>
		</header>
		<div class="entry-media">
												</div>
		<div class="entry-content">
			<div class="entry themeform">
				
								
					<p>I am guessing that this has been done before elsewhere but it was a new idea for me anyway.</p>
<p>A couple of weeks ago <a href="http://www.nsftools.com/blog/blog-08-2006.htm#08-28-06">Julian</a> and <a href="http://dominoweb.blogspot.com/2006/06/ajax-autocompletion-avec-scriptaculous.html">Philippe</a> were talking about using the <a href="http://wiki.script.aculo.us/scriptaculous/show/Ajax.Autocompleter">Scriptaculous Autocomplete</a> feature. Philippe had the cracking idea of using a page to do DBLookups on the fly to provide <a href="http://www.json.org/">JSON</a> data.</p>
<p>While on the train this morning I came up with the idea of performing complex form validation using a similar technique. The sort of thing I am thinking of is uniqueness checking, complex business rules and so on but without the overhead of firing up an agent to do the processing, submitting to a form will do that same task much faster.</p>
<p>It&#8217;s definitely worth having a read of Philippe&#8217;s article that I mentioned earlier. What I am proposing is that rather than running a &quot;GET&quot; request from a page which he suggested for the autocomplete tool, that we create a simple form which we &quot;POST&quot; to, to make sure that all of the fields are valid, before submitting the &quot;real&quot; form to be saved. Let me describe things in a little more detail. I have a form which is registering a new user for an application. I need to make sure that the company name of the user is valid and that his email address has not been used for any other users that are already registered. Now this is pretty simple stuff to handle with normal form validation or webquerysave agents but I am not a big fan of the user submitting, waiting for a screen refresh only then to be told they&#8217;ve got something wrong.</p>
<p>So instead, before submitting the form, we run some javascript which creates an AJAX request (as usual I am using Prototype but you can use your preferred framework). My submit function looks something like this:</p>
<blockquote>
<pre style="BORDER-RIGHT: #999999 1px dashed; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px dashed; PADDING-LEFT: 5px; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; OVERFLOW: auto; BORDER-LEFT: #999999 1px dashed; WIDTH: 100%; COLOR: #000000; LINE-HEIGHT: 14px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px dashed; FONT-FAMILY: Andale Mono, Lucida Console, Monaco, fixed, monospace; BACKGROUND-COLOR: #eee"><code>function submitClient() {
//Now we do the server side validation
var a=$H(
{
clientnameandcode: $F(&quot;clientnameandcode&quot;),
email: $F(&quot;email&quot;)
}
);
var myAjax = new Ajax.Request(
'/validateNewclient?createdocument&amp;rand=' + Math.floor(Math.random()*1001),
{method: 'post', parameters: a.toQueryString(), onComplete: submitclientContinue}
);
}
function submitclientContinue(jsonDoc) {
if (jsonDoc.responseText == &quot;\n&quot;) {
//All the validation has been passed so submit properly
document.forms[0].submit();
}else{
//There are error messages so display them in a div on the form
$(&quot;validation&quot;).innerHTML = &quot;
<p>&quot; + jsonDoc.responseText +&quot;</p>
&quot;;
$(&quot;validation&quot;).style.display = &quot;&quot;;
}
}
</code></pre>
</blockquote>
<p>
The two fields I am interested in, clientnameandcode and email are posted to the form called &quot;validateNewClient&quot;. The form then has the following design:<br>
<img alt="" src="/11tmr.nsf/0/d364cf76c9c5aecf802571f600535125/$FILE/formvalidation.jpg" border="0"></p>
<p>
The things to note are&#8230;</p>
<li>The SaveOptions field which is set to &quot;0&quot; to prevent the document being saved
</li>
<li>The two data fields which match the parameters sent in by the AJAX request
</li>
<li>The $$Return formula which actually does all of the validation work, it just computes some response messages where there are errors, or empty string for successes.
<p>Now the only &quot;hack&#8217; I&#8217;ve had to do is with the return value from the $$Return, where because @SetHTTPHeader(&quot;Content-Type&quot;; &quot;text/text&quot;) doesn&#8217;t work I have to redirect the message I want to return to a page where I can format the message as simple text to be returned to the AJAX request.</p>
<p>This isn&#8217;t an approach which I would recommend for every situation, but where you have relatively complex business rules which need to be validated and the network can handle the extra load etc then I think it&#8217;s quite neat.</p>
<p>Of course the one caveat is that with client side validation you must always, always double check on the server side to prevent sneaky people circumventing all of the Javascript you have written to make their lives easier!</p>
<p>Technorati Tags: <a href="http://technorati.com/tag/Show-N-Tell+Thursday">Show-N-Tell Thursday</a></p>
</li>
				
								
			</div>
		</div>
	</div>
	
	<div class="entry-meta group">
		<div class="entry-meta-inner">
			<span class="posted-on">September 27, 2006</span>
			<span class="byline">by <span class="author"><a href="/author/mattwhite/" title="Posts by mattwhite" rel="author">mattwhite</a></span></span>
							<a class="entry-comments" href="/2006-9-27-posting-to-a-form-for-ajax-validation-html/#respond"><i class="fas fa-comment"></i><span>0</span></a>
					</div>
	</div>

</article><!--/.post-->						</div>
		
		<nav class="pagination group">
			<div class="wp-pagenavi" role="navigation">
<span class="pages">Page 1 of 2</span><span aria-current="page" class="current">1</span><a class="page larger" title="Page 2" href="/category/show-n-tell-thursday/page/2/">2</a><a class="nextpostslink" rel="next" aria-label="Next Page" href="/category/show-n-tell-thursday/page/2/">&raquo;</a>
</div>	</nav><!--/.pagination-->
		
	
</div>
<!--/.content-->


	<div class="sidebar s1">

		<div class="sidebar-content">
		
						
			
						
		</div>
<!--/.sidebar-content-->
		
	</div>
<!--/.sidebar-->
	

					</div>
<!--/.main-inner-->
				</div>
<!--/.main-->	
			</div>
<!--/.container-inner-->
		</div>
<!--/.container-->
		
		<footer id="footer">
		
							
						
						
			<div id="footer-bottom">
				
				<a id="back-to-top" href="#"><i class="fas fa-angle-up"></i></a>
					
				<div class="pad group">
					
					<div class="grid one-full">
						
												
						<div id="copyright">
															<p>mattwhite.me &copy; 2022. All Rights Reserved.</p>
													</div>
<!--/#copyright-->
						
												<div id="credit">
							<p>Powered by <a href="https://wordpress.org/" rel="nofollow">WordPress</a>. Theme by <a href="http://alx.media/" rel="nofollow">Alx</a>.</p>
						</div>
<!--/#credit-->
												
					</div>
					
					<div class="grid one-full">	
																								</div>
				
				</div>
<!--/.pad-->

			</div>
<!--/#footer-bottom-->

		</footer><!--/#footer-->
	
	</div>
<!--/#wrapper-inner-->
</div>
<!--/#wrapper-->

<script type="text/javascript" src="/wp-content/themes/blogstream/js/jquery.fitvids.js?ver=6.0.1" id="blogstream-fitvids-js"></script>
<script type="text/javascript" src="/wp-content/themes/blogstream/js/jq-sticky-anything.min.js?ver=6.0.1" id="blogstream-jq-sticky-anything-js"></script>
<script type="text/javascript" src="/wp-content/themes/blogstream/js/scripts.js?ver=6.0.1" id="blogstream-scripts-js"></script>
<script type="text/javascript" src="/wp-content/themes/blogstream/js/nav.js?ver=1661702752" id="blogstream-nav-script-js"></script>
	<script>
	/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
	</script>
	</body>
</html>